#summary Generate custom reports from nodes

= Introduction =

As we have all facts, classes and agents for nodes we can do some custom reporting on all of these.

We've added a tool - _mc-inventory_ - that has a very simple scriptable report language.

 *Note: This is an emerging feature, the scripting language is likely to change*

= Details =

To obtain a full inventory for a given node you can run mc-inventory like this:

{{{
$ mc-inventory your.node.com
Inventory for your.node.com:

   Agents:
      discovery       echo            nrpe           
      package         process         puppetd        
      rpctest         service                        

   Configuration Management Classes:
      aliases                        apache
      <snip>
   Facts:
      architecture => i386
      country => de
      culturemotd => 1
      customer => rip
      diskdrives => xvda
      <snip>
}}}

This gives you a good idea of all the details available for a node.

Lets say you now need a report of all your IBM hardware listing hostname, serial number and product name you can write a scriptlet like this:

{{{
inventory do
    format "%s:\t\t%s\t\t%s"

    fields { [ identity, facts["serialnumber"], facts["productname"] ] }
end
}}}

And if saved as _inventory.mc_ run it like this:

{{{
$ mc-inventory -W "productname=/IBM|BladeCenter/" --script inventory.mc
xx12:           99xxx21         BladeCenter HS22 -[7870B3G]-
xx9:            99xxx46         BladeCenter HS22 -[7870B3G]-
xx10:           99xxx29         BladeCenter HS22 -[7870B3G]-
yy1:            KDxxxFR         IBM System x3655 -[79855AY]-
xx5:            99xxx85         IBM eServer BladeCenter HS21 -[8853GLG]-
<snip>
}}}

We'll add more capabilities in the future, for now you can access _facts_ as a hash, _agents_ and _classes_ as arrays as well as _identity_ as a string.
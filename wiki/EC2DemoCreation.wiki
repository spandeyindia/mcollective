#summary Notes on how the EC2 demo is created

= RightScale AMI =
Start up ami _ami-efe4cf9b_ or a newer RightScale EC2 image

= Packages Needed =
Install the following RPMs:

{{{
facter
tanukiwrapper
activemq
mcollective
mcollective-client
mcollective-common
rubygem-stomp
rubygems
ruby-shadow
puppet
net-snmp-libs
lm_sensors
net-snmp
perl-Socket6
nrpe
perl-Crypt-DES
perl-Digest-SHA1
nagios-plugins
perl-Digest-HMAC
perl-Net-SNMP
xinetd
}}}

= File modifications =
Most of the files needed are in SVN in the _ext/ec2demo_ directory.

{{{
.
|-- etc
|   |-- activemq
|   |   `-- activemq.xml.templ
|   |-- mcollective
|   |   |-- client.cfg.templ
|   |   `-- server.cfg.templ
|   |-- nagios
|   |   |-- command-plugins.cfg
|   |   |-- nrpe.cfg
|   |   `-- nrpe.d
|   |       |-- check_disks.cfg
|   |       |-- check_load.cfg
|   |       |-- check_swap.cfg
|   |       |-- check_totalprocs.cfg
|   |       `-- check_zombieprocs.cfg
|   |-- rc.d
|   |   `-- rc.local
|   `-- xinetd.d
|       `-- nrpe
|-- opt
|   `-- rightscale
|       `-- etc
|           `-- motd-complete
|-- root
|   `-- README.txt
`-- usr
    |-- lib
    |   `-- ruby
    |       `-- site_ruby
    |           `-- 1.8
    |               `-- facter
    |                   `-- rightscale.rb
    `-- local
        |-- bin
        |   `-- start-mcollective-demo.rb
        `-- etc
            `-- mcollective-node.motd
}}}

= Bundling Changes =
Bundling up is based on [http://support.rightscale.com/12-Guides/01-RightScale_Dashboard_User_Guide/02-Clouds/01-EC2/08-EC2_Image_Locator/Register_an_AMI#Step_2.3a_Bundle_the_Instance RightScale docs].

You need to copy your key, cert and have your credentials all into _/mnt_:

{{{
cp /dev/null /root/.bash_history
rm -rf /var/tmp/mcollective/

ec2-bundle-vol -d /mnt -k pk-xx.pem -c cert-xx.pem -u 481328239245 -r i386
ec2-upload-bundle -b mcollective-041-demo -m image.manifest.xml -a xx -s xxx
}}}

Now register the AMI in the [https://console.aws.amazon.com/ec2 AWS console] then make public after testing